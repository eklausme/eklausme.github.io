<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABbklEQVQ4T2OUn/2+loGRoZqR4T87AwngPwPjT4b/DK2M8nPe/yBVM8wekCGMCnPe/SfBYgylKAYk67AzMCEp2ff4N4O+KAvDtz//GXY8+M1gKcnCoCHEzDD/6k+4KhQD7iQKMDAyMjD8h7qp6OBXhgx9DoZX3/4zJOz8wrDMk4eBn52RwXvDZ9wGgExvPfUdrmBbIC/YgKojXxkOhvEzzLz0g6Hn7A/SDPj48z/Dz7//GcwlWBmc1nxkeP4VEWwYXgB6l+EnkJh75QfDpAs/GUAu0BRiYfgH9FfZoa8Ma+/8RglIDAMuvfnLcPTZb4aTz/8wHHn2B8WAEqAB6wkZgC0MQF74/ZeBwUSChcFp9UeGF8AwgQEMF+AKxNpjXxn2h/AzTAcGYi++QMQXjSu8eBh42fBEY7ouOzgdwMDeR78ZDKAJaev93wzWUiwMWsCENPsKjoRETpKmPDOBsjPQ2dXABExSdmYA5kRg0mgFAI5W3Y01yGITAAAAAElFTkSuQmCC" rel="icon" type="image/x-icon">

	<link rel="canonical" href="https://eklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot">
	<link rel="alternate" type="application/rss+xml" title="RSS" href="https://eklausmeier.goip.de/feed.xml">
	<meta name="author" content="Elmar Klausmeier">
	<meta name="copyright" content="Elmar Klausmeier">
	<meta name="generator" content="Simplified Saaze">

<script src="https://analytics.ahrefs.com/analytics.js" data-key="yTUhMMEASRjeaM8armGiZQ" async></script>

	<title>SQLite Storage for J-Pilot - Elmar Klausmeier's Blog on Computers, Programming, and Mathematics</title>

	<link href="/jscss/prism.css" rel=stylesheet>
<style>
/* CSS for Elmar Klausmeier's blog
   09-Aug-2021: Initial revision
   25-Aug-2021: Added transformed anchor a
   27-Jun-2022: dark/light switcher, see https://ihuoma.hashnode.dev/darklight-mode-switcher
   11-Jul-2022: p+ul+ol same font
   09-Aug-2022: fixed <a...> on tablets, removed commented-out stuff
   28-May-2023: centered content, added background color
   16-Oct-2023: added Google fonts
   23-Oct-2023: added pagefind dark mode
   16-Nov-2023: added kbd
   04-Nov-2024: centered tables, aside on the left side
*/

@import url("https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,400;0,700;1,400;1,700&family=Noto+Sans+Mono:wght@400;700&family=UnifrakturMaguntia&display=swap");

:root { --bgSurrounding:#fffff6; --bgAcolor:white; color:black; --h1Color:DarkBlue; --thColor:LightBlue; --nthChild:#f2f2f2; --klmwidth:46rem; }
.dark-mode { background-color:#22160B; color:white; --bgAcolor:black; --h1Color:LightBlue; --thColor:DarkBlue; --nthChild:#935116;
	--pagefind-ui-primary: #eeeeee; --pagefind-ui-text: #eeeeee; --pagefind-ui-background: #152028; --pagefind-ui-border: #152028; --pagefind-ui-tag: #152028;
}
body {
	background-color: var(--bgSurrounding);
	font-family:Merriweather,Georgia,"Times New Roman",ui-serif,Cambria,Times,serif;
	font-display:optional;
	/*font-size: 28px;  font-weight: 100;*/
	margin: auto;
	width:var(--klmwidth)
}
h1::first-letter, h2::first-letter { font-family:UnifrakturMaguntia; color:brown }
article, aside { background-color: var(--bgAcolor); border-radius:8px }

a { color:inherit }
a:hover { background-color:sandybrown }
strong { font-weight:900 }
.symbols { font-family:'Noto Sans Symbols 2'; font-size:36px }


img[alt=Photo] { width:var(--klmwidth) }

table { margin-left:auto; margin-right:auto }
img { border-radius:8px; margin-left:auto; margin-right:auto; display:block }
blockquote { font-style:italic; padding-left:0.4rem; border-left:2px solid #ccc }
td { border:1px solid Black; border-collapse:collapse; padding:0.3rem 0.5rem 0.3rem 0.5rem }
th { border:1px solid Black; background-color:var(--thColor); padding:0.3rem 0.5rem 0.3rem 0.5rem; position:sticky; top:0 }
tr:nth-child(even) { background-color:var(--nthChild); }

kbd {   /* https://www.rgagnon.com/jsdetails/js-nice-effect-the-KBD-tag.html */
	margin: 0px 0.1em;
	padding: 0.1em 0.6em;
	border-radius: 3px;
	border: 1px solid rgb(204, 204, 204);
	color: rgb(51, 51, 51);
	line-height: 1.4;
	font-family: Arial,Helvetica,sans-serif;
	font-size: 16px;
	display: inline-block;
	box-shadow: 0px 1px 0px rgba(0,0,0,0.2), inset 0px 0px 0px 2px #ffffff;
	background-color: rgb(247, 247, 247);
	-moz-box-shadow: 0 1px 0px rgba(0, 0, 0, 0.2), 0 0 0 2px #ffffff inset;
	-webkit-box-shadow: 0 1px 0px rgba(0, 0, 0, 0.2), 0 0 0 2px #ffffff inset;
	-moz-border-radius: 3px;
	-webkit-border-radius: 3px;
	text-shadow: 0 1px 0 #fff;
}

@media screen and (min-width:50rem) {
	main, aside { max-width:46rem }
	h1 { font-size:3em; color:var(--h1Color) }
	h2 { font-size:2.7em; color:var(--h1Color) }
	h3 { font-size:2.2em; color:var(--h1Color) }
	h4 { font-size:2em; color:var(--h1Color) }
	p { line-height:1.7; font-size:1.3rem }
	blockquote { line-height:1.5; font-size:1.3rem }
	ul, ol { line-height:1.5; font-size:1.3rem }
	li { margin-bottom:0.6rem }
	pre { color:#e2e8f0; background-color:#2d3748; border-radius:0.4rem; overflow-x:auto; padding:1.4rem }
	pre code { color:#e2e8f0; line-height:1.8; font-size:1.1rem; font-weight:400; }
	code[class*="language-"], pre[class*="language-"] { line-height:1.5; font-size:1.15rem }
}
@media screen and (max-width:50rem) {
	main, aside, header, footer { max-width:46rem; margin-left:0.3rem; margin-right:0.3rem }
	/*body { width:100% }*/
	h1 { font-size:2.2em; color:var(--h1Color) }
	h2 { font-size:1.7em; color:var(--h1Color) }
	h3 { font-size:1.4em; color:var(--h1Color) }
	h4 { font-size:1.2em; color:var(--h1Color) }
	p { line-height:1.5; font-size:1.0rem }
	ul, ol { line-height:1.4; font-size:1.0rem }
	li { margin-bottom:0.4rem }
	pre { color:#e2e8f0; background-color:#2d3748; border-radius:0.4rem; overflow-x:auto }
	pre code { color:#e2e8f0; line-height:1.3; font-size:1em }
}
@media screen and (max-width:46rem) {
	body, main, aside, header, footer { max-width:45rem; margin-left:0.3rem; margin-right:0.3rem }
}
@media screen and (max-width:34rem) {
	body, main, aside, header, footer { max-width:33rem; margin-left:0.3rem; margin-right:0.3rem }
}
@media screen and (max-width:24rem) {
	body, main, aside, header, footer { max-width:23rem; margin-left:0.3rem; margin-right:0.3rem }
}
@media screen and (max-width:20rem) {
	body, main, aside, header, footer { max-width:19rem; margin-left:0.3rem; margin-right:0.3rem }
}

.dimmedColor { color:Gray }
footer { font-family:sans-serif; color:Gray }
.chartarea { height:400px; width:600px }

/* Copied from TailwindCSS 2.0 typography.min.css */
pre, code { font-family:"Noto Sans Mono" }
code { color:inherit; font-weight:700; font-size:inherit }
code::before { content:"`" }
code::after { content:"`" }
pre > code { font-weight:400 }
pre code::before { content:"" }
pre code::after{ content:"" }


nav { border-radius:8px }
/* Copied from W.S.Toh: https://code-boxx.com/simple-responsive-pure-css-hamburger-menu */
#hamnav {	/* [ON BIG SCREENS] (A) WRAPPER */
	/*width: var(--klmwidth);*/
	background: Lightgray;
	/* Optional */
	position: sticky;
	top: 0;
}

#hamitems { display:flex }	/* (B) HORIZONTAL MENU ITEMS */
#hamitems a {
	flex-grow: 2;
	/*flex-basis: 0;*/
	padding: 12px;
	/*color: white;*/
	text-decoration: none;
	margin-left: 0rem;
	text-align: left;
	font-size:1.6rem;
}
/*#hamitems a:hover { background:Sandybrown }*/

#hamnav label, #hamburger { display:none }	/* (C) HIDE HAMBURGER */

.grid-container {	/* Holy Grail Layout */
	display:grid;
	grid-template-areas:
		'header'
		'main'
		'aside'
		'footer';
	gap: 0.1rem;
	justify-content:center;
	text-wrap:wrap;
	text-align:left;
}

header { grid-area:header }
main { grid-area:main }
aside { grid-area:aside; background-color:moccasin }
footer { grid-area:footer }

@media screen and (min-width:95rem) {
	.grid-container {
		display: grid;
		width: 100%;
		grid-template-columns: 40rem 47rem;
		grid-template-areas:
			'header header'
			'aside main'
			'footer footer';
		gap: 2rem 4rem;
		background-color: var(--bgSurrounding);
		padding: 0.8rem;
	}
}

@media screen and (max-width: 50rem) {	/* [ON SMALL SCREENS] */
	#hamitems a {	/* (A) BREAK INTO VERTICAL MENU */
		box-sizing: border-box;
		display: block;
		/*width: 100%;*/
		border-top: 1px solid #333;
	}
	#hamnav label {	/* (B) SHOW HAMBURGER ICON */
		display: inline-block;
		color: white;
		background: DarkGreen;	/*#a02620;*/
		font-style: normal;
		font-size: 1.2em;
		padding: 10px;
	}
	#hamitems { display:none }	/* (C) TOGGLE SHOW/HIDE MENU */
	#hamnav input:checked ~ #hamitems { display:block }
}



</style>

<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
<script src="/pagefind/pagefind-ui.js"></script>
<script>
	window.addEventListener('DOMContentLoaded', (event) => {
		new PagefindUI({ element: "#search", showSubResults: true });
	});
</script>

</head>

<body class=grid-container>

	<header> 
		<nav id=hamnav>	<!-- (A) MENU WRAPPER -->
		<label for=hamburger>&#9776;</label><!-- (B) THE HAMBURGER -->
			<input type=checkbox id=hamburger>
		<div id=hamitems>	<!-- (C) MENU ITEMS -->
			<a href="/blog">Blog</a>
			<a href="/aux/about">About</a>
			<a href="/music" aria-label="Music"><svg version="1.1" id="musicIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height=32 width=32 x="0px" y="0px" viewBox="0 0 104.23 122.88" style="enable-background:new 0 0 104.23 122.88; fill:Navy" xml:space="preserve"><style type="text/css">.st0{fill-rule:evenodd;clip-rule:evenodd;}</style><g><path class="st0" d="M87.9,78.04c2.74-0.48,5.33-0.4,7.6,0.13V24.82L39.05,41.03v61.95c0.03,0.34,0.05,0.69,0.05,1.03 c0,0,0,0.01,0,0.01c0,8.34-8.75,16.62-19.55,18.49C8.76,124.37,0,119.12,0,110.77c0-8.34,8.76-16.62,19.55-18.48 c4.06-0.7,7.84-0.39,10.97,0.71l0-76.26h0.47L104.04,0v85.92c0.13,0.63,0.2,1.27,0.2,1.91c0,0,0,0,0,0.01 c0,6.97-7.32,13.89-16.33,15.44c-9.02,1.56-16.33-2.83-16.33-9.8C71.57,86.51,78.88,79.59,87.9,78.04L87.9,78.04L87.9,78.04z"/></g></svg></a>
			<a href="/gallery" aria-label="Gallery"><svg version="1.1" id="galleryIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height=32 width=32 x="0px" y="0px" viewBox="0 0 122.88 90.78" style="enable-background:new 0 0 122.88 90.78; fill:black" xml:space="preserve"><style type="text/css">.st0{fill-rule:evenodd;clip-rule:evenodd;}</style><g><path class="st0" d="M46.86,0.05h43.63l9.94,17.7h20.48c1.09,0,1.98,0.92,1.98,1.98v69.08c0,1.06-0.91,1.98-1.98,1.98H1.98 C0.92,90.78,0,89.89,0,88.81l0-69.08c0-1.09,0.89-1.98,1.98-1.98h9.21V11.4h11.38v6.35h12.36c2.57-5.08,5.14-10.15,7.71-15.23 C44.2-0.57,43.34,0.05,46.86,0.05L46.86,0.05z M110.07,26.5c3.26,0,5.9,2.64,5.9,5.9c0,3.26-2.64,5.9-5.9,5.9 c-3.26,0-5.9-2.64-5.9-5.9C104.18,29.14,106.82,26.5,110.07,26.5L110.07,26.5L110.07,26.5z M66.64,33.37 c9.87,0,17.88,8.01,17.88,17.88c0,9.87-8.01,17.88-17.88,17.88c-9.87,0-17.88-8.01-17.88-17.88 C48.76,41.38,56.77,33.37,66.64,33.37L66.64,33.37z M66.64,21.73c16.31,0,29.53,13.22,29.53,29.53c0,16.3-13.22,29.53-29.53,29.53 c-16.3,0-29.53-13.23-29.53-29.53C37.12,34.95,50.34,21.73,66.64,21.73L66.64,21.73z"/></g></svg></a>
			<a href="/aux/yearOverview" aria-label="Year Overview"><svg id="yearOverviewIcon" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" height=32 width=32 viewBox="0 0 122.88 121"><defs><style>.cls-1{fill:#ef4136;}.cls-1,.cls-3,.cls-5{fill-rule:evenodd;}.cls-2{fill:gray;}.cls-3{fill:#e6e6e6;}.cls-4{fill:#1a1a1a;}.cls-5{fill:#c72b20;}</style></defs><title>Year Overview</title><path class="cls-1" d="M11.52,6.67h99.84a11.57,11.57,0,0,1,11.52,11.52V44.94H0V18.19A11.56,11.56,0,0,1,11.52,6.67Zm24.79,9.75A9.31,9.31,0,1,1,27,25.73a9.31,9.31,0,0,1,9.31-9.31Zm49.79,0a9.31,9.31,0,1,1-9.31,9.31,9.31,9.31,0,0,1,9.31-9.31Z"/><path class="cls-2" d="M111.36,121H11.52A11.57,11.57,0,0,1,0,109.48V40H122.88v69.46A11.56,11.56,0,0,1,111.36,121Z"/><path class="cls-3" d="M12.75,117.31h97.38a9.1,9.1,0,0,0,9.06-9.06V40H3.69v68.23a9.09,9.09,0,0,0,9.06,9.06Z"/><path class="cls-4" d="M39.54,100.77V66H32.29V58.42l8.6-3.69H51.47v46Zm19.46,0V91.31L73.2,76.8a28.28,28.28,0,0,0,2.27-2.52A11.27,11.27,0,0,0,76.91,72a5.21,5.21,0,0,0,.53-2.27A4.18,4.18,0,0,0,77,67.61a2.82,2.82,0,0,0-1.51-1.2A7.94,7.94,0,0,0,72.83,66H59.73V56.58q3-.69,6.73-1.26a56.19,56.19,0,0,1,8.64-.59,20.11,20.11,0,0,1,8.52,1.48A8.86,8.86,0,0,1,88,60.57a17,17,0,0,1,1.32,7.07,16.89,16.89,0,0,1-3.1,10.08A31.85,31.85,0,0,1,82.6,82l-7.87,8.06H90.59v10.69Z"/><path class="cls-5" d="M86.1,14.63a11.11,11.11,0,1,1-7.85,3.26l.11-.1a11.06,11.06,0,0,1,7.74-3.16Zm0,1.79a9.31,9.31,0,1,1-9.31,9.31,9.31,9.31,0,0,1,9.31-9.31Z"/><path class="cls-5" d="M36.31,14.63a11.11,11.11,0,1,1-7.85,3.26l.11-.1a11.08,11.08,0,0,1,7.74-3.16Zm0,1.79A9.31,9.31,0,1,1,27,25.73a9.31,9.31,0,0,1,9.31-9.31Z"/><path class="cls-4" d="M80.54,4.56C80.54,2,83,0,86.1,0s5.56,2,5.56,4.56V25.77c0,2.51-2.48,4.56-5.56,4.56s-5.56-2-5.56-4.56V4.56Z"/><path class="cls-4" d="M30.75,4.56C30.75,2,33.24,0,36.31,0s5.56,2,5.56,4.56V25.77c0,2.51-2.48,4.56-5.56,4.56s-5.56-2-5.56-4.56V4.56Z"/></svg></a>
			<a onclick="return darkLightToggle()" aria-label="Switch between light and dark mode"><svg version="1.1" id="darkLightIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="32" width="32" x="0px" y="0px" viewBox="0 0 122.8 122.8" style="enable-background:new 0 0 240 240" xml:space="preserve"><g><path d="M49.06,1.27c2.17-0.45,4.34-0.77,6.48-0.98c2.2-0.21,4.38-0.31,6.53-0.29c1.21,0.01,2.18,1,2.17,2.21 c-0.01,0.93-0.6,1.72-1.42,2.03c-9.15,3.6-16.47,10.31-20.96,18.62c-4.42,8.17-6.1,17.88-4.09,27.68l0.01,0.07 c2.29,11.06,8.83,20.15,17.58,25.91c8.74,5.76,19.67,8.18,30.73,5.92l0.07-0.01c7.96-1.65,14.89-5.49,20.3-10.78 c5.6-5.47,9.56-12.48,11.33-20.16c0.27-1.18,1.45-1.91,2.62-1.64c0.89,0.21,1.53,0.93,1.67,1.78c2.64,16.2-1.35,32.07-10.06,44.71 c-8.67,12.58-22.03,21.97-38.18,25.29c-16.62,3.42-33.05-0.22-46.18-8.86C14.52,104.1,4.69,90.45,1.27,73.83 C-2.07,57.6,1.32,41.55,9.53,28.58C17.78,15.57,30.88,5.64,46.91,1.75c0.31-0.08,0.67-0.16,1.06-0.25l0.01,0l0,0L49.06,1.27 L49.06,1.27z"/></g></svg></a>
			<a href="/aux/uses" aria-label="Uses"><svg class="svg-icon" width="34" height="34" style="vertical-align:middle; fill:DarkGreen; overflow:hidden" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M864 128l-704 0C140.8 128 128 140.8 128 160l0 512C128 691.2 140.8 704 160 704l236.8 0 0 128L256 832l0 64 512 0 0-64L627.2 832l0-128 236.8 0c19.2 0 32-12.8 32-32l0-512C896 140.8 883.2 128 864 128zM864 640c0 19.2-12.8 32-32 32L192 672c-19.2 0-32-12.8-32-32L160 192c0-19.2 12.8-32 32-32l640 0c19.2 0 32 12.8 32 32L864 640z"  /></svg></a>
			<a href="/aux/blogroll" aria-label="Blogroll"><svg version="1.1" id="Blogroll" xmlns="http://www.w3.org/2000/svg" x="0" y="0" width="32" height="32"
				viewBox="0 0 482.136 482.135" style="enable-background:new 0 0 482.136 482.135; fill:Navy"
				xml:space="preserve"><g><path d="M455.482,198.184L326.829,326.832c-35.535,35.54-93.108,35.54-128.646,0l-42.881-42.886l42.881-42.876l42.884,42.876
		c11.845,11.822,31.064,11.846,42.886,0l128.644-128.643c11.816-11.831,11.816-31.066,0-42.9l-42.881-42.881
		c-11.822-11.814-31.064-11.814-42.887,0l-45.928,45.936c-21.292-12.531-45.491-17.905-69.449-16.291l72.501-72.526
		c35.535-35.521,93.136-35.521,128.644,0l42.886,42.881C491.018,105.045,491.018,162.663,455.482,198.184z M201.206,366.698
		l-45.903,45.9c-11.845,11.846-31.064,11.817-42.881,0l-42.884-42.881c-11.845-11.821-11.845-31.041,0-42.886l128.646-128.648
		c11.819-11.814,31.069-11.814,42.884,0l42.886,42.886l42.876-42.886l-42.876-42.881c-35.54-35.521-93.113-35.521-128.65,0
		L26.655,283.946c-35.538,35.545-35.538,93.146,0,128.652l42.883,42.882c35.51,35.54,93.11,35.54,128.646,0l72.496-72.499
		C246.724,384.578,222.588,379.197,201.206,366.698z"/></g></svg></a>
			<a href="/sitemap.html" aria-label="Sitemap"><svg id="sitemapIcon" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" height=32 width=32 viewBox="0 0 113.84 122.88"><defs><style>.cls-2{fill-rule:evenodd;}</style></defs><title>Sitemap</title><path class="cls-2" d="M1.78,4,.18,7.55H44.23L42.61,4H23a1.17,1.17,0,0,1-1.18-1.17V0H5.05V2.81A1.17,1.17,0,0,1,3.87,4Zm67.7,95.21,2.88,22.22a1.49,1.49,0,0,0,1.36,1.47h35c.81,0,1.26-.78,1.36-1.5l3.73-22.19Zm1.78-5.77L69.66,97h44l-1.62-3.57H92.44a1.17,1.17,0,0,1-1.18-1.17V89.44H74.52v2.81a1.17,1.17,0,0,1-1.17,1.17ZM66.87,55.49l2.89,22.22a1.48,1.48,0,0,0,1.35,1.47h35c.81,0,1.26-.78,1.36-1.5l3.73-22.19Zm1.78-5.77-1.6,3.57H111.1l-1.62-3.57H89.83a1.17,1.17,0,0,1-1.17-1.18v-2.8H71.92v2.81a1.18,1.18,0,0,1-1.18,1.17ZM25.18,62.65H58.7v6H25.18v42H58.37v6H19.18V37.71h6V62.65ZM0,9.75,2.88,32a1.5,1.5,0,0,0,1.36,1.47h35c.81,0,1.26-.78,1.36-1.5L44.36,9.75Z"/></svg></a>
			<a href="/aux/categories" aria-label="Categories"><svg version="1.1" id="catIcon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height=32 width=32 x="0px" y="0px" viewBox="0 0 102.78 123.1" style="enable-background:new 0 0 102.78 123.1" xml:space="preserve"><style type="text/css">.st0{fill-rule:evenodd;clip-rule:evenodd;stroke:#000000;stroke-width:0.216;stroke-miterlimit:2.6131;}</style><g><path class="st0" d="M53.79,29.73c1.54,0,2.78,1.25,2.78,2.78s-1.25,2.78-2.78,2.78S51,34.05,51,32.52S52.25,29.73,53.79,29.73 L53.79,29.73z M58.1,118.65l0.06,0h0.31c0.48-0.01,0.57-0.06,0.94-0.3l0.36-0.23c4.77-3.01,7.04-7.46,7.57-12.92 c0.56-5.8-0.8-12.77-3.26-20.4l0,0c-0.01-0.03-0.02-0.06-0.03-0.09L57.9,62.32c-0.6,0.26-1.19,0.51-1.79,0.75 c-2.35,0.98-4.77,1.71-7.24,2.22c-2.66,0.57-5.33,0.88-8.01,0.93c-5.72,0.09-11.44-1.04-17.17-3.4l-3.65,14.36 c-0.7,2.74-1.28,5.17-1.76,7.36c-0.51,2.32-0.97,4.58-1.39,6.88c-0.21,1.13-0.33,1.75-0.45,2.38c-1.33,6.85-2.74,14.15,1.09,19.9 c1.09,1.64,2.5,2.85,4.2,3.66c1.74,0.82,3.8,1.25,6.16,1.31c0.05,0,0.09,0,0.14,0h2.79V95.37c0-1.18,0.96-2.14,2.14-2.14 c1.18,0,2.14,0.96,2.14,2.14v23.28h11.49V95.37c0-1.18,0.96-2.14,2.14-2.14c1.18,0,2.14,0.96,2.14,2.14v23.28H58.1L58.1,118.65z M14.21,1.45l8.09,7.7c6-2.42,12.05-3.72,18.15-3.78c6.12-0.05,12.26,1.16,18.43,3.77l9.05-8.46c0.86-0.8,2.2-0.76,3,0.1 c0.38,0.41,0.57,0.93,0.57,1.44h0l0.11,18.06c2.46,4.3,3.92,8.31,4.53,12.07l3.63-1.18c1.12-0.36,2.32,0.25,2.69,1.37 c0.36,1.12-0.25,2.32-1.37,2.69l-4.61,1.5c0,0.1,0,0.2-0.01,0.29c-0.08,3.19-0.8,6.16-2.04,8.95l2.92,0.39 c1.17,0.15,1.99,1.22,1.84,2.39c-0.15,1.17-1.22,1.99-2.39,1.84l-4.59-0.61c-0.29,0.44-0.6,0.87-0.92,1.3 c-2.73,3.67-5.99,6.62-9.57,8.89l6.42,23.33h0c2.62,8.14,4.06,15.66,3.44,22.1c-0.49,5.13-2.25,9.56-5.69,13.05h10.46h0.11v0.01 c6.98,0,12.4,0,17.7-5.14c3.08-2.98,4.37-6.8,4.26-10.6c-0.06-2.08-0.55-4.17-1.39-6.13c-0.85-1.97-2.05-3.79-3.54-5.33 c-2.92-3.01-6.97-4.97-11.68-4.83c-1.17,0.03-2.15-0.89-2.19-2.07c-0.03-1.17,0.89-2.15,2.07-2.19c6-0.18,11.15,2.29,14.85,6.11 c1.87,1.93,3.36,4.19,4.4,6.62c1.04,2.43,1.65,5.06,1.72,7.7c0.15,4.93-1.53,9.88-5.54,13.77c-6.55,6.34-12.71,6.34-20.67,6.34 v0.01h-0.11H58.56l-0.2,0h-9.12c-0.17,0.04-0.35,0.07-0.53,0.07c-0.18,0-0.36-0.02-0.53-0.07h-14.7c-0.17,0.04-0.35,0.07-0.53,0.07 c-0.18,0-0.36-0.02-0.53-0.07h-4.4c-0.08,0-0.15,0-0.23-0.01c-2.97-0.07-5.61-0.63-7.89-1.71c-2.41-1.14-4.4-2.85-5.94-5.16 c-4.79-7.2-3.21-15.37-1.72-23.05c0.19-0.96,0.37-1.91,0.45-2.34c0.42-2.3,0.89-4.61,1.43-7.03c0.56-2.54,1.15-5.01,1.78-7.49 l3.91-15.37c-4.32-2.53-7.98-5.91-10.53-10.02C9.14,50.51,9,50.28,8.87,50.06l-3.45,0.43c-1.17,0.14-2.23-0.69-2.38-1.86 c-0.14-1.17,0.69-2.23,1.86-2.38l2.05-0.25c-1.08-2.92-1.64-6.11-1.59-9.53l-3.78-1.23c-1.12-0.36-1.73-1.57-1.37-2.69 c0.36-1.12,1.57-1.73,2.69-1.37l2.85,0.93c0.6-3.71,1.9-7.65,4.02-11.8l0.84-17.41c0.06-1.17,1.05-2.08,2.23-2.03 C13.38,0.89,13.85,1.11,14.21,1.45L14.21,1.45L14.21,1.45z M20.37,13.2l-5.73-5.45l-0.64,13.21l0,0c-0.01,0.3-0.09,0.6-0.24,0.88 c-2.16,4.13-3.41,8.01-3.89,11.6l13.38,4.34c1.12,0.36,1.73,1.57,1.37,2.69c-0.36,1.12-1.57,1.73-2.69,1.37L9.66,37.85 c0.11,2.74,0.7,5.28,1.67,7.59l11.01-1.37c1.17-0.14,2.23,0.69,2.38,1.86c0.14,1.17-0.69,2.24-1.86,2.38l-9.3,1.16 c2.23,3.2,5.31,5.85,8.89,7.87c4.01,2.26,8.65,3.72,13.5,4.28c4.29,0.5,8.72,0.28,12.99-0.71c1.64-0.4,3.28-0.91,4.92-1.53 c5.15-2.03,9.86-5.33,13.55-10.06l-7.62-1.02c-1.17-0.15-1.99-1.22-1.84-2.39c0.15-1.17,1.22-1.99,2.39-1.84l9.64,1.29 c1.18-2.28,1.93-4.68,2.16-7.24l-11.42,3.7c-1.12,0.36-2.32-0.25-2.69-1.37c-0.36-1.12,0.25-2.32,1.37-2.69l12.63-4.1 c-0.47-3.57-1.88-7.47-4.38-11.75h0c-0.18-0.31-0.29-0.68-0.29-1.07L67.28,7.11l-6.43,6.02c-0.61,0.64-1.58,0.85-2.43,0.47 c-6.02-2.74-12-4.01-17.94-3.96c-5.94,0.05-11.87,1.43-17.8,3.98l0,0C21.92,13.94,21.01,13.8,20.37,13.2L20.37,13.2z M37.54,39.46 c-1.18,0-2.14-0.96-2.14-2.14s0.96-2.14,2.14-2.14h6.61c1.18,0,2.14,0.96,2.14,2.14s-0.96,2.14-2.14,2.14h-1.2 c0.08,1.25,0.3,2.35,0.63,3.28c0.49,1.4,1.23,2.42,2.12,3.07c0.87,0.64,1.91,0.97,3.03,0.99c0.86,0.02,1.77-0.14,2.71-0.47 c1.11-0.39,2.33,0.19,2.72,1.3c0.39,1.11-0.19,2.33-1.3,2.72c-1.41,0.5-2.83,0.74-4.22,0.71c-2-0.04-3.87-0.63-5.46-1.81 c-0.79-0.59-1.51-1.31-2.13-2.17c-0.55,0.89-1.2,1.59-1.95,2.15c-2.49,1.85-5.65,1.86-9.07,1.38c-1.17-0.16-1.98-1.24-1.82-2.4 c0.16-1.17,1.24-1.98,2.4-1.82c2.44,0.34,4.61,0.41,5.93-0.58c1.2-0.9,1.98-2.8,2.09-6.35H37.54L37.54,39.46z M28.12,29.73 c1.54,0,2.78,1.25,2.78,2.78s-1.25,2.78-2.78,2.78c-1.54,0-2.78-1.25-2.78-2.78S26.58,29.73,28.12,29.73L28.12,29.73z"/></g></svg></a>
			<a href="/aux/privacy-policy" aria-label="Privacy Policy"><svg xmlns="http://www.w3.org/2000/svg" height=32 width=32 shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 511 512.35"><path d="M162.62 21.9c-5.49 5.43-10.63 12.02-15.42 19.71-17.37 27.82-30.33 69.99-39.92 123.16-56.3 10.64-91.06 34.14-89.9 58.14 1.04 21.74 28.46 38.41 69.67 49.92-2.71 8.38-2.07 9.82 1.6 20.13-30.78 12.98-62.94 52.4-88.65 86.93l100.03 67.61-35.32 64.85h384.41l-37.26-64.85L511 378.63c-29.08-40.85-64.19-75.56-86.12-84.98 4.63-12.02 5.44-14.12 1.56-20.79 41.21-11.72 68.23-28.84 68.17-51.47-.06-24.68-35.5-48.38-88.31-56.62-12.64-53.5-25.22-95.62-41.23-123.27-2.91-5.02-5.93-9.57-9.09-13.62-47.66-61.12-64.36-2.69-98.14-2.76-39.17-.08-44.15-53.69-95.22-3.22zm67.12 398.37c-3.57 0-6.47-2.9-6.47-6.47s2.9-6.47 6.47-6.47h10.52c1.38 0 2.66.44 3.7 1.17 3.77 2.1 7.46 3.33 11.01 3.42 3.54.09 7.14-.96 10.8-3.45a6.515 6.515 0 0 1 3.61-1.11l12.78-.03c3.57 0 6.46 2.9 6.46 6.47s-2.89 6.47-6.46 6.47h-10.95c-5.46 3.27-10.98 4.67-16.54 4.53-5.44-.14-10.78-1.77-16.01-4.53h-8.92zm-69.12-140.78c60.43 21.74 120.87 21.38 181.3 1.83-58.45 4.75-122.79 3.62-181.3-1.83zm208.37-.86c20.89 70.63-68.53 106.5-101.95 27.98h-22.11c-34.12 78.28-122.14 44.17-102.16-28.94-7.31-.8-14.51-1.68-21.56-2.62l-.32 1.88-.59 3.56-3.48 20.87c-30.39-6.72-13.36 71.77 14.26 64.87 4.22 12.18 7.69 22.62 11.26 32.19 36.81 98.83 190.88 104.81 226.95 6.36 3.78-10.32 6.85-21.64 11.24-35.39 25.44 4.06 46.35-73.31 15.34-67.63l-3.19-21.05-.55-3.65-.23-1.54c-7.47 1.16-15.12 2.2-22.91 3.11zM123.7 176.34l7.43-25.43c48.16 40.42 214.59 34.09 250.87 0l6.26 25.43c-42.31 44.75-219.33 38.67-264.56 0z"/></svg></a>
			<a href="/feed.xml" aria-label="RSS Feed"><svg xmlns="http://www.w3.org/2000/svg" height="32" viewBox="0 -960 960 960" width="32" style="background-color:orange; fill:white"><path d="M200-120q-33 0-56.5-23.5T120-200q0-33 23.5-56.5T200-280q33 0 56.5 23.5T280-200q0 33-23.5 56.5T200-120Zm480 0q0-117-44-218.5T516-516q-76-76-177.5-120T120-680v-120q142 0 265 53t216 146q93 93 146 216t53 265H680Zm-240 0q0-67-25-124.5T346-346q-44-44-101.5-69T120-440v-120q92 0 171.5 34.5T431-431q60 60 94.5 139.5T560-120H440Z"/></svg></a>
		</div>
		</nav>
	</header>

	<main>
<div id="search"></div>



	<article>
	<p class=dimmedColor><time datetime="2022-12-04 18:00:00">4th December 2022</time>, 10 min read</p>
<h1>SQLite Storage for J-Pilot</h1>
<p>Original post is here <a href="https://eklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot">eklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot</a>.</p>
<br>
<p>I am using <a href="https://en.wikipedia.org/wiki/J-Pilot">J-Pilot</a> since more than 20 years. I am using it on a daily basis. I do no longer use any Palm device. I had owned a <a href="https://en.wikipedia.org/wiki/Palm_III">Palm III</a>, a <a href="https://en.wikipedia.org/wiki/Palm_V">Palm V</a>, and a <a href="https://en.wikipedia.org/wiki/Palm_Tungsten">Tungsten</a>, but they all failed at some point in time, and are no longer usable. Therefore, I do no HotSync between PC and Palm device. I use J-Pilot as a stand-alone application. But I do copy my datebook, and address data to my Android devices, see <a href="/blog/2015/03-21-importing-calendar-data-to-google-calendar">Importing Calendar Data to Google-Calendar</a> and <a href="/blog/2020/03-19-j-pilot-data-on-android-phone-contacts">J-Pilot Data on Android Phone: Contacts</a>.</p>
<p>My first Palm device, the Palm III, was a gift from my brother, who bought them at the <a href="https://www.sap.com/about/events/sapphire.html">SAPPHIRE</a> conference in the US. Before using this device, I kept my addresses in a MS-Word file, which I printed out on paper every few weeks, whenever too many changes were written on the previous paper. When I started with the Palm III, I was still using MS Windows. Therefore, I used the original Palm Windows application, which looks pretty similar to J-Pilot, well, no wonder. Starting in 2001 I began using Linux, and J-Pilot was one of my first applications in regular use.</p>
<p>Around ten years ago I proposed to store the J-Pilot data in SQLite, see <a href="/blog/2013/02-27-enhancements-to-j-pilot">Possible Enhancements to J-Pilot</a>, instead of using the internal pdb/pc3-format. Two years ago I devised a datamodel for this, see <a href="/blog/2020/04-27-sql-datamodel-for-j-pilot">SQL Datamodel For J-Pilot</a>. I implemented a J-Pilot plugin, which stores J-Pilot data in SQLite, see <a href="/blog/2020/04-29-j-pilot-plugin-for-sqlite-export">J-Pilot Plugin For SQLite Export</a>. This plugin is working like an export mechanism, i.e., once you press a button, all data from the internal format is stored in SQLite — but J-Pilot itself still uses the internal pdb/pc3-format.</p>
<p>Now I have implemented all the necessary changes within J-Pilot, so that J-Pilot no longer uses the internal pdb/pc3-format, but rather reads and writes all its data from/to SQLite. No pdb/pc3-files are used anymore. Also, the alarm file and the preference file is stored within SQLite. Only <code>jpilot.log</code>, <code>jpilotcss.default</code>, and <code>jpilot.plugins</code> remain as separate files. The rest is stored in <code>jptables.db</code>, a SQLite3 file.</p>
<pre class="line-numbers"><code class="language-bash">$ ls -l .jpilot
total 20308
-rw-r--r--  1 klm klm    8750 Sep 12 16:20 jpilotcss.default
-rw-------  1 klm klm       0 Mar 27  2021 jpilot.plugins
-rw-------  1 klm klm 7217152 Dec  3 15:23 jptables.db
drwxr-xr-x  2 klm klm    4096 Nov 26 18:33 old/
drwxr-xr-x  2 klm klm    4096 Nov 26 17:16 plugins/
</code></pre>
<p>I also fixed the issues mentioned in <a href="/blog/2022/11-06-crashing-j-pilot">Crashing J-Pilot</a>. Another null-pointer exceptions in ToDo's was also fixed along the way.</p>
<p>I am productive since 26-Nov-2022, i.e., I am only using the new version based on SQLite.</p>
<p><strong>1. Code changes.</strong> Main program <code>jpilot.c</code> now uses <code>getopt()</code> so that options can be merged without given separate dashes for each individual option. For example, you can now start <code>jpilot</code> like so</p>
<pre class="line-numbers"><code class="language-bash">jpilot -Sdr
</code></pre>
<p>I added opions <code>-S</code> for SQLite storage and option <code>-r</code> to suppress permanent saving into preference file. I noticed that J-Pilot constantly writes into <code>jpilot.rc</code>. In many cases this is not necessary, or just superflous. Therefore this additional option <code>-r</code>. When you start <code>jpilot</code> <em>without</em> <code>-S</code> it will behave as before, i.e., everything will be saved in pdb/pc3-files.</p>
<p>The other executables were not changed to use <code>getopt()</code>, as they lose their importance, when data is stored in SQLite. For example, <code>jpilot-dump</code> is no longer required, when data can easily be accessed via SQLite. Same with <code>jpilot-merge</code>. <code>jpilot-dump</code> reads pdb/pc3-files and produces text files. <code>jpilot-merge</code> combines pdb and pc3 into a single pdb file.</p>
<p>Overall the changes in the existing code basis are very few. Essentially they look like this:</p>
<pre class="line-numbers"><code class="language-C">if (glob_sqlite) jpsqlite_DatebookSEL(&amp;cel,NULL,1);
else get_days_calendar_events2(&amp;cel, NULL, 2, 2, 1, CATEGORY_ALL, NULL);
</code></pre>
<p>All interaction with SQLite is in <code>libsqlite.c</code>.</p>
<p>As proposed in <a href="/blog/2013/02-27-enhancements-to-j-pilot">Possible Enhancements to J-Pilot</a> the search routine no longer makes unnecessary <code>malloc()</code> and <code>free()</code> calls, i.e., <code>jp_strstr()</code> now uses <code>strcasestr()</code>.</p>
<p>Serious development started in October and finished in November 2022. In November I tried to check each functionality in J-Pilot at least once, so that it still works with SQLite. I made quite intensive use of gdb, using Marc Heisenko's <a href="https://darkdust.net/files/GDB%20Cheat%20Sheet.pdf">cheat-sheet</a>. The debug-option in J-Pilot, <code>-d</code>, also proved to be very valuable to see which functions are involved.</p>
<div class=mermaid>
%%{init: { 'gitGraph':{'mainBranchName':'master'} } }%%
gitGraph
    commit id: "ccb225a"
    commit id: "6aaded5"
    branch feature-gtk3
    commit id: "9ba0ce5"
    commit id: "0a8989b" tag: "2.0.1"
    commit id: "..."
    commit id: "200d954" type: HIGHLIGHT
    commit id: "7ec8251"
    commit id: "73f4179"
    checkout master
    commit id: "5170c25"
    commit id: "8c43c5b"
</div>
<p>I started development at Git commit <code>200d954</code> in the <code>feature-gtk3</code> branch, but incorporated the changes contained in the two later commits. Though, they lead to a warning during compilation.</p>
<p>Overview of lines of code.</p>
<table><tr>
    <td><table>
<tr><th> LOC   <th> words  <th>chars   <th>C file
<tr><td>    526<td>    1577<td>   15486<td> ./address.c
<tr><td>   4740<td>   13369<td>  196368<td> ./address_gui.c
<tr><td>   1082<td>    2825<td>   31590<td> ./alarms.c
<tr><td>    633<td>    1800<td>   18635<td> ./calendar.c
<tr><td>   1020<td>    3080<td>   37367<td> ./category.c
<tr><td>    803<td>    2277<td>   22486<td> ./contact.c
<tr><td>     94<td>     545<td>    3599<td> ./cp1250.c
<tr><td>   1273<td>    3599<td>   35669<td> ./dat.c
<tr><td>    890<td>    3082<td>   27454<td> ./datebook.c
<tr><td>   5936<td>   16826<td>  235733<td> ./datebook_gui.c
<tr><td>    387<td>    1035<td>   13964<td> ./dialer.c
<tr><td>    554<td>    1594<td>   13309<td> ./dialer/jpilot-dial.c
<tr><td>   2195<td>    6110<td>   77753<td> ./Expense/expense.c
<tr><td>    369<td>     982<td>   12981<td> ./export_gui.c
<tr><td>     86<td>     148<td>    2494<td> ./font.c
<tr><td>   4873<td>   38304<td>  245635<td> ./icons/icons.c
<tr><td>    436<td>    1211<td>   14841<td> ./import_gui.c
<tr><td>    477<td>    1278<td>   16768<td> ./install_gui.c
<tr><td>    278<td>     814<td>    9608<td> ./install_user.c
<tr><td>    244<td>    1017<td>    7150<td> ./japanese.c
<tr><td>     76<td>     307<td>    2467<td> ./jp-contact.c
<tr><td>   2242<td>    6554<td>   76522<td> ./jpilot.c
<tr><td>   1916<td>    5521<td>   71820<td> ./jpilot-dump.c
<tr><td>    317<td>    1020<td>    9877<td> ./jpilot-merge.c
<tr><td>    282<td>     982<td>    9037<td> ./jpilot-sync.c
<tr><td>    859<td>    2483<td>   30071<td> ./jpsqlite/jpsqlite.c
<tr><td>   2903<td>    8331<td>  101505<td> ./KeyRing/keyring.c
<tr><td>    950<td>    2500<td>   25866<td> ./libplugin.c
<tr><td>   2018<td>    6174<td>   86382<td> ./libsqlite.c
<tr><td>    215<td>     715<td>    6094<td> ./log.c
<tr><td>    386<td>    1079<td>   10269<td> ./memo.c
<tr><td>   2049<td>    5748<td>   72251<td> ./memo_gui.c
<tr><td>    544<td>    1608<td>   18430<td> ./monthview_gui.c
<tr><td>    329<td>    1053<td>    9129<td> ./otherconv.c
<tr><td>    367<td>    1086<td>   10509<td> ./password.c
<tr><td>    105<td>     332<td>    2875<td> ./pidfile.c
<tr><td>    445<td>    1331<td>   13382<td> ./plugins.c
<tr><td>    916<td>    2613<td>   26913<td> ./prefs.c
<tr><td>   1012<td>    2898<td>   38779<td> ./prefs_gui.c
<tr><td>   1340<td>    3507<td>   40224<td> ./print.c
<tr><td>    355<td>     975<td>   12070<td> ./print_gui.c
<tr><td>    906<td>    4400<td>   37995<td> ./print_headers.c
<tr><td>    453<td>     649<td>   32340<td> ./print_logo.c
<tr><td>    383<td>    1172<td>   15482<td> ./restore_gui.c
<tr><td>    127<td>     319<td>    4695<td> ./russian.c
<tr><td>    741<td>    1935<td>   26316<td> ./search_gui.c
<tr><td>   3862<td>   12436<td>  128907<td> ./sync.c
<tr><td>    118<td>     401<td>    3545<td> ./SyncTime/synctime.c
<tr><td>    437<td>    1542<td>   12280<td> ./task.c
<tr><td>    520<td>    1446<td>   13885<td> ./todo.c
<tr><td>   2769<td>    7564<td>  106979<td> ./todo_gui.c
<tr><td>   3838<td>   11945<td>  120301<td> ./utils.c
<tr><td>    403<td>    1170<td>   13742<td> ./weekview_gui.c
<tr><td>  61079<td>  203269<td> 2229829<td> total
    </table>
    <td><table>
<tr><th> LOC   <th> words  <th>chars   <th>header file
<tr><td>    95<td>    428<td>   3527<td> ./address.h
<tr><td>    30<td>    194<td>   1328<td> ./alarms.h
<tr><td>    65<td>    287<td>   2633<td> ./calendar.h
<tr><td>   205<td>    944<td>   5724<td> ./config.h
<tr><td>    30<td>    175<td>   1156<td> ./cp1250.h
<tr><td>   142<td>    662<td>   4833<td> ./datebook.h
<tr><td>    53<td>    239<td>   2047<td> ./export.h
<tr><td>   265<td>   1207<td>   9470<td> ./gettext.h
<tr><td>    38<td>    185<td>   1283<td> ./i18n.h
<tr><td>   278<td>    814<td>   5882<td> ./icons/appl_menu_icons.h
<tr><td>   215<td>    695<td>   4607<td> ./icons/list_mini_icons.h
<tr><td>   101<td>    388<td>   2828<td> ./icons/lock_icons.h
<tr><td>    28<td>    146<td>   1063<td> ./install_user.h
<tr><td>    30<td>    170<td>   1202<td> ./japanese.h
<tr><td>    24<td>    156<td>   1110<td> ./jpilot.h
<tr><td>    59<td>    269<td>   2073<td> ./jp-pi-contact.h
<tr><td>   379<td>   1541<td>  11324<td> ./libplugin.h
<tr><td>    53<td>    310<td>   2889<td> ./libsqlite.h
<tr><td>    51<td>    258<td>   1935<td> ./log.h
<tr><td>    39<td>    190<td>   1492<td> ./memo.h
<tr><td>    39<td>    224<td>   1524<td> ./otherconv.h
<tr><td>    51<td>    251<td>   1702<td> ./password.h
<tr><td>    27<td>    152<td>   1076<td> ./pidfile.h
<tr><td>    92<td>    384<td>   2797<td> ./pi-task.h
<tr><td>    89<td>    312<td>   2819<td> ./plugins.h
<tr><td>    23<td>    143<td>   1011<td> ./prefs_gui.h
<tr><td>   187<td>    754<td>   6367<td> ./prefs.h
<tr><td>    77<td>    318<td>   2847<td> ./print.h
<tr><td>    28<td>    166<td>   1216<td> ./print_headers.h
<tr><td>    22<td>    154<td>   1029<td> ./print_logo.h
<tr><td>    26<td>    152<td>   1062<td> ./restore.h
<tr><td>    29<td>    164<td>   1166<td> ./russian.h
<tr><td>    49<td>    225<td>   1890<td> ./stock_buttons.h
<tr><td>    59<td>    231<td>   1902<td> ./sync.h
<tr><td>    68<td>    253<td>   2359<td> ./todo.h
<tr><td>   592<td>   2267<td>  18441<td> ./utils.h
<tr><td>  3638<td>  15408<td> 117614<td> total
    </table>
</table>
<p><code>libsqlite.c</code> and <code>libsqlite.h</code> are entirely new. <code>libjpsqlite.c</code> is the plugin, which I wrote two years ago, see <a href="/blog/2020/04-29-j-pilot-plugin-for-sqlite-export">J-Pilot Plugin For SQLite Export</a>.</p>
<p><strong>2. Limitations.</strong> The current implementation with storing all data in SQLite has some limitations:</p>
<ol>
<li>currently no HotSync with your Palm device</li>
<li>no &quot;Calendar&quot;, just &quot;Datebook&quot; — main difference being the first having categories</li>
<li>no contact (i.e., version 2 address), which has 39 fields, while version 1 (a.k.a. address) having 20 fields</li>
<li>no undelete as all insertions, updates and deletions happen directly on the SQLite database</li>
</ol>
<p>I investigated whether I should also implement &quot;Calendar&quot; and &quot;Contact v2&quot;, but saw no compelling reason for me, so left that. If others raise their voice for that being included, I will surely reconsider.</p>
<p><strong>3. File format.</strong> SQLite as file format has a number of advantages over the previous internal format stored in pdb/pc3 files. Below points are reproduced from <a href="https://sqlite.org/aff_short.html">SQLite As An Application File Format</a>:</p>
<blockquote>
<ol>
<li>Better performance: Reading and writing from an SQLite database is often faster than reading and writing individual files from disk.</li>
<li>Reduced complexity.</li>
<li>Portability: The application file is portable across all operating systems, 32-bit and 64-bit and big- and little-endian architectures. I.e., SQLite can be read and written on Intel/AMD and ARM.</li>
<li>Reliability: Content can be updated continuously and atomically so that little or no work is lost in a power failure or crash.</li>
<li>Accessibility: SQLite database content can be viewed using a wide variety third-party tools. SQLite database files are recommended by the US Library of Congress as a storage format for long-term preservation of digital content.</li>
</ol>
</blockquote>
<p><strong>4. Moving from pdb/pc3 to SQLite.</strong> I had written a J-Pilot plugin, which stores the internal format in SQLite format. This plugin is now part of the J-Pilot source-tree, similar to the Expense plugin. This allows an easy migration from old to new format. That way you can get warm with the new format, but still using the pdb/pc3 storage format. I used this approach for more than two years.</p>
<p>The SQLite plugin and the sole storage in SQLite are two entirely separate things. One can use one without the other. I.e., one can use the SQLite plugin without actually storing the entire data in SQLite, and vice versa, once you have stored all your data in SQLite, then there is no real need for the plugin anymore.</p>
<p><strong>5. Outlook.</strong> SQLite is the native data storage format for Android apps. Therefore, the next step would be to implement an Android app to continue to use the SQLite data format. The HotSync mechanism was outlined in <a href="/blog/2020/04-27-sql-datamodel-for-j-pilot">SQL Datamodel For J-Pilot</a>. Currently I am still unsure what route to follow:</p>
<ol>
<li><a href="https://en.wikipedia.org/wiki/Progressive_web_app">PWA</a> (progressive web app) making the use of an app-store unneccessary. The <a href="https://play.google.com/store/apps/details?id=com.weather.forecast.weatherchannel&amp;hl=en">Google Android weather app</a> is a prominent example of a PWA.</li>
<li><a href="https://webassembly.org">WebAssembly</a> based app using current J-Pilot source.</li>
<li>App programmed in <a href="https://en.wikipedia.org/wiki/Flutter_(software)">Flutter</a> using the Dart programming language. <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.walletnfcrel&amp;hl=en">Google Wallet</a> (a.k.a. Google Pay) is a prominent example of an app written in Flutter/Dart.</li>
</ol>
<p>All routes would provide the J-Pilot functionality on Android and iOS.</p>
<p>The source code of J-Pilot is easy to read and understand. In particular, some longer functions contain all the processing required, instead of calling millions of small, but otherwise useless mini-functions. Nevertheless, some possible improvements:</p>
<ol>
<li>J-Pilot uses <a href="https://en.wikipedia.org/wiki/Automake">automake</a> to generate the final Makefile, which is quite arcane. A possible alternative would be <a href="https://en.wikipedia.org/wiki/Ninja_(build_system)">Ninja</a>, or use a plain Makefile. Though, there is this saying, &quot;if it ain't broke, don't fix it&quot;.</li>
<li>Definition of global variables should be concentrated in a single C file, possibly within a <code>struct</code> like so:</li>
</ol>
<pre class="line-numbers"><code class="language-C">struct {
    int app, rc_file_write, date_time_flag, child_pid, sqlite;
} glob;
</code></pre>
	</article>
	</main>

	<br><br>
	<aside>
	<p>Share via
	<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Feklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot" title="Post on Facebook" target=_blank>Facebook</a>,
	<a href="https://twitter.com/intent/tweet?text=SQLite+Storage+for+J-Pilot%0Ahttps%3A%2F%2Feklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot" title="Post on Twitter" target=_blank>Twitter/&Xopf;</a>,
	<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Feklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot" title="Post on LinkedIn" target=_blank>LinkedIn</a>,
	<a href="https://www.xing.com/spi/shares/new?url=https%3A%2F%2Feklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot" title="Post on Xing" target=_blank>Xing</a>,
	<a href="https://share.flipboard.com/bookmarklet/popout?v=2&amp;title=SQLite+Storage+for+J-Pilot&amp;url=https%3A%2F%2Feklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot" title="Post on Flipboard" target=_blank>Flipboard</a>,
	<a href="https://getpocket.com/save?url=https%3A%2F%2Feklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot" title="Post on Pocket" target=_blank>Pocket</a>,
	<a href="https://reddit.com/submit?&amp;url=https%3A%2F%2Feklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot&amp;title=SQLite+Storage+for+J-Pilot" title="Post on Reddit" target=_blank>Reddit</a>,
	<a href="mailto:?subject=SQLite+Storage+for+J-Pilot&amp;body=https%3A%2F%2Feklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot" title="Send via e-mail">e-mail</a>,
	<a href="whatsapp://send?text=SQLite+Storage+for+J-Pilot%0Ahttps%3A%2F%2Feklausmeier.goip.de/blog/2022/12-04-sqlite-storage-for-j-pilot" title="Post on WhatsApp">WhatsApp</a>
	</p>

	<p>
	<br><strong><a href=/aux/categories>Categories</a>: </strong><a href=/aux/categories/#J-Pilot>J-Pilot</a>
	<br><strong><a href=/aux/tags>Tags</a>: </strong><a href=/aux/tags/#SQLite>SQLite</a>
	<br><strong>Author: </strong>Elmar Klausmeier
	</p>
	<p><a href="/blog/2022">Index for the year 2022.</a></p>
	<p>Blog posts with the same categories.</p>
	<p><i>J-Pilot:</i></p>
	<ol>
		<li><a href="/blog/2013/02-17-jpilot-dump">2013-02-17: jpilot-dump + jpilot-merge</a></li>
		<li><a href="/blog/2013/02-27-enhancements-to-j-pilot">2013-02-27: Possible Enhancements to J-Pilot</a></li>
		<li><a href="/blog/2013/05-01-a-praise-for-icewm">2013-05-01: A Praise for IceWM</a></li>
		<li><a href="/blog/2014/04-14-syncing-with-j-pilot-via-bluetooth">2014-04-14: Syncing with J-Pilot via Bluetooth</a></li>
		<li><a href="/blog/2015/03-21-importing-calendar-data-to-google-calendar">2015-03-21: Importing Calendar Data to Google-Calendar</a></li>
		<li><a href="/blog/2020/03-19-j-pilot-data-on-android-phone-contacts">2020-03-19: J-Pilot Data on Android Phone: Contacts</a></li>
		<li><a href="/blog/2020/04-27-sql-datamodel-for-j-pilot">2020-04-27: SQL Datamodel For J-Pilot</a></li>
		<li><a href="/blog/2020/04-29-j-pilot-plugin-for-sqlite-export">2020-04-29: J-Pilot Plugin For SQLite Export</a></li>
		<li><a href="/blog/2020/06-09-splitting-and-anti-merging-vcard-files">2020-06-09: Splitting and anti-merging vCard files</a></li>
		<li><a href="/blog/2021/03-02-testing-j-pilot-feature-gtk3-branch">2021-03-02: Testing J-Pilot feature-gtk3 branch</a></li>
		<li><a href="/blog/2022/10-09-renumbering-j-pilot-sqlite-data">2022-10-09: Renumbering J-Pilot SQLite Data</a></li>
		<li><a href="/blog/2022/11-06-crashing-j-pilot">2022-11-06: Crashing J-Pilot</a></li>
		<li><a href="/blog/2023/04-08-j-pilot-usage-statistics">2023-04-08: J-Pilot Usage Statistics</a></li>
		<li><a href="/blog/2023/05-06-accessing-j-pilot-data-from-mobile-and-web">2023-05-06: Accessing J-Pilot Data From Mobile And Web</a></li>
		<li><a href="/blog/2025/03-06-building-j-pilot-and-pilot-link-on-linux">2025-03-06: Building J-Pilot and Pilot-Link on Linux</a></li>
	</ol>
	</aside>


	<footer>
		<p><br><br>Generated 23-Mar-25 16:47 CET (Europe/Berlin) using <a href="/blog/2021/10-31-simplified-saaze">Simplified Saaze</a>, rendered in 160.90 ms<br><br>
		</p>
	</footer>


<script>
function darkLightToggle(setLocal=1) {
	if (setLocal) {
		let dts = localStorage.getItem("dark-theme") ?? 0;
		if (dts != 1 && dts != 0) dts = 0;	// in case the user has tampered with localStorage
		localStorage.setItem("dark-theme", 1 - dts);
	}
	document.body.classList.toggle("dark-mode");
	darkLightIcon.innerHTML = document.body.classList.contains("dark-mode") ?
		'<g><path d="M58.57,25.81c-2.13-3.67-0.87-8.38,2.8-10.51c3.67-2.13,8.38-0.88,10.51,2.8l9.88,17.1c2.13,3.67,0.87,8.38-2.8,10.51 c-3.67,2.13-8.38,0.88-10.51-2.8L58.57,25.81L58.57,25.81z M120,51.17c19.01,0,36.21,7.7,48.67,20.16 C181.12,83.79,188.83,101,188.83,120c0,19.01-7.7,36.21-20.16,48.67c-12.46,12.46-29.66,20.16-48.67,20.16 c-19.01,0-36.21-7.7-48.67-20.16C58.88,156.21,51.17,139.01,51.17,120c0-19.01,7.7-36.21,20.16-48.67 C83.79,58.88,101,51.17,120,51.17L120,51.17z M158.27,81.73c-9.79-9.79-23.32-15.85-38.27-15.85c-14.95,0-28.48,6.06-38.27,15.85 c-9.79,9.79-15.85,23.32-15.85,38.27c0,14.95,6.06,28.48,15.85,38.27c9.79,9.79,23.32,15.85,38.27,15.85 c14.95,0,28.48-6.06,38.27-15.85c9.79-9.79,15.85-23.32,15.85-38.27C174.12,105.05,168.06,91.52,158.27,81.73L158.27,81.73z M113.88,7.71c0-4.26,3.45-7.71,7.71-7.71c4.26,0,7.71,3.45,7.71,7.71v19.75c0,4.26-3.45,7.71-7.71,7.71 c-4.26,0-7.71-3.45-7.71-7.71V7.71L113.88,7.71z M170.87,19.72c2.11-3.67,6.8-4.94,10.48-2.83c3.67,2.11,4.94,6.8,2.83,10.48 l-9.88,17.1c-2.11,3.67-6.8,4.94-10.48,2.83c-3.67-2.11-4.94-6.8-2.83-10.48L170.87,19.72L170.87,19.72z M214.19,58.57 c3.67-2.13,8.38-0.87,10.51,2.8c2.13,3.67,0.88,8.38-2.8,10.51l-17.1,9.88c-3.67,2.13-8.38,0.87-10.51-2.8 c-2.13-3.67-0.88-8.38,2.8-10.51L214.19,58.57L214.19,58.57z M232.29,113.88c4.26,0,7.71,3.45,7.71,7.71 c0,4.26-3.45,7.71-7.71,7.71h-19.75c-4.26,0-7.71-3.45-7.71-7.71c0-4.26,3.45-7.71,7.71-7.71H232.29L232.29,113.88z M220.28,170.87 c3.67,2.11,4.94,6.8,2.83,10.48c-2.11,3.67-6.8,4.94-10.48,2.83l-17.1-9.88c-3.67-2.11-4.94-6.8-2.83-10.48 c2.11-3.67,6.8-4.94,10.48-2.83L220.28,170.87L220.28,170.87z M181.43,214.19c2.13,3.67,0.87,8.38-2.8,10.51 c-3.67,2.13-8.38,0.88-10.51-2.8l-9.88-17.1c-2.13-3.67-0.87-8.38,2.8-10.51c3.67-2.13,8.38-0.88,10.51,2.8L181.43,214.19 L181.43,214.19z M126.12,232.29c0,4.26-3.45,7.71-7.71,7.71c-4.26,0-7.71-3.45-7.71-7.71v-19.75c0-4.26,3.45-7.71,7.71-7.71 c4.26,0,7.71,3.45,7.71,7.71V232.29L126.12,232.29z M69.13,220.28c-2.11,3.67-6.8,4.94-10.48,2.83c-3.67-2.11-4.94-6.8-2.83-10.48 l9.88-17.1c2.11-3.67,6.8-4.94,10.48-2.83c3.67,2.11,4.94,6.8,2.83,10.48L69.13,220.28L69.13,220.28z M25.81,181.43 c-3.67,2.13-8.38,0.87-10.51-2.8c-2.13-3.67-0.88-8.38,2.8-10.51l17.1-9.88c3.67-2.13,8.38-0.87,10.51,2.8 c2.13,3.67,0.88,8.38-2.8,10.51L25.81,181.43L25.81,181.43z M7.71,126.12c-4.26,0-7.71-3.45-7.71-7.71c0-4.26,3.45-7.71,7.71-7.71 h19.75c4.26,0,7.71,3.45,7.71,7.71c0,4.26-3.45,7.71-7.71,7.71H7.71L7.71,126.12z M19.72,69.13c-3.67-2.11-4.94-6.8-2.83-10.48 c2.11-3.67,6.8-4.94,10.48-2.83l17.1,9.88c3.67,2.11,4.94,6.8,2.83,10.48c-2.11,3.67-6.8,4.94-10.48,2.83L19.72,69.13L19.72,69.13z"/></g>' :
		'<g><path d="M49.06,1.27c2.17-0.45,4.34-0.77,6.48-0.98c2.2-0.21,4.38-0.31,6.53-0.29c1.21,0.01,2.18,1,2.17,2.21 c-0.01,0.93-0.6,1.72-1.42,2.03c-9.15,3.6-16.47,10.31-20.96,18.62c-4.42,8.17-6.1,17.88-4.09,27.68l0.01,0.07 c2.29,11.06,8.83,20.15,17.58,25.91c8.74,5.76,19.67,8.18,30.73,5.92l0.07-0.01c7.96-1.65,14.89-5.49,20.3-10.78 c5.6-5.47,9.56-12.48,11.33-20.16c0.27-1.18,1.45-1.91,2.62-1.64c0.89,0.21,1.53,0.93,1.67,1.78c2.64,16.2-1.35,32.07-10.06,44.71 c-8.67,12.58-22.03,21.97-38.18,25.29c-16.62,3.42-33.05-0.22-46.18-8.86C14.52,104.1,4.69,90.45,1.27,73.83 C-2.07,57.6,1.32,41.55,9.53,28.58C17.78,15.57,30.88,5.64,46.91,1.75c0.31-0.08,0.67-0.16,1.06-0.25l0.01,0l0,0L49.06,1.27 L49.06,1.27z"/></g>' ;
}
const darkLightIcon = document.querySelector("#darkLightIcon");
addEventListener('load', (event) => {
	let dst = localStorage.getItem("dark-theme");
	if (dst == 1	// explicit user request
	|| (dst == null && window.matchMedia('(prefers-color-scheme: dark)').matches )) { // as per Browser setting
		darkLightToggle(0);
	} else {
		document.body.classList.remove('dark-mode');
	}
});
</script>

	<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
	<script>mermaid.initialize({startOnLoad:true});</script>
	<script src="/jscss/prism.js"></script>


</body>
</html>
